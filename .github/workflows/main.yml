name: github pages

on:
  push:
    branches: ["master", "react-switch"]
jobs:
  deploy:
    runs-on: ubuntu-18.04
        steps:
        - uses: actions/checkout@v2
        - name: Setup Node
            uses: actions/setup-node@v2-beta
            with:
            node-version: '12'
            working-directory: "./gabau.github.io"
        - name: Get npm cache directory
          id: npm-cache
          run: |
            echo "::set-output name=dir::$(npm config get cache)"
          
          working-directory: "./gabau.github.io"
        - uses: actions/cache@v1
          with:
            path: ${{ steps.npm-cache.outputs.dir }}
            key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
            restore-keys: |
              ${{ runner.os }}-node-
            
          working-directory: "./gabau.github.io"
        - name: Grab dependencies
          run: npm install && npm run build && mv ./dist ../
          working-directory: "./gabau.github.io"
        - uses: EndBug/add-and-commit@v9
          with:
            default_author: github_actions
            add: |
              - ./dist
